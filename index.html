<?xml version='1.0' encoding='UTF-8' ?>
<html xmlns='http://www.w3.org/1999/xhtml'>
	<head>
		<meta charset='utf-8'/>
		<title>Vas Music Stream</title>

		<style></style>

		<script>
            'use strict'
			let CONF

            const text = x => x.text()

            function remote(f, ...args)
                { return `(${f.toString()})(${args.map(JSON.stringify).join(', ')})` }

            function walk_music_directory(dir)
                { return Array.from(walk_directory(dir)) }

            function get(url) { return fetch(url).then(text) }
            function post(url, data) { return fetch(url, { method: 'POST', body: data }).then(text) }

            async function main()
                { CONF = await get('conf.json').then(JSON.parse)
                post('/', remote(walk_music_directory, CONF.music)).then(console.log) }

            main()
		</script>
	</head>

	<body>
		<h1>Vas Music Stream</h1>
	</body>
</html>
